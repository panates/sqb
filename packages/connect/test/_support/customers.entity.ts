import {
    BaseEntity, Column, Entity, HasOne, PrimaryKey,
    Sort, SortDescending, LazyResolver, AutoGenerated, SortAscending
} from '@sqb/connect';
import {Country} from './countries.entity';

@Entity('customers')
export class Customer extends BaseEntity {
    @PrimaryKey()
    @Column({fieldName: 'ID', autoGenerate: 'increment'})
    @SortDescending()
    id?: number;

    @Column({fieldName: 'given_name'})
    @Sort()
    givenName?: string;

    @Column({
        fieldName: 'family_name',
        sortAscending: true,
        sortDescending: true
    })
    familyName?: string;

    @Column({fieldName: 'birth_date'})
    @Sort()
    birthDate?: Date;

    @Column({fieldName: 'city'})
    city?: string;

    @Column({fieldName: 'country_code'})
    countryCode?: string;

    @Column({fieldName: 'created_at', update: false})
    @AutoGenerated('timestamp')
    @SortAscending()
    createdAt?: Date;

    @Column({fieldName: 'updated_at', insert: false})
    @AutoGenerated('timestamp')
    @SortDescending()
    updatedAt?: Date;

    @HasOne({
        target: Country,
        column: 'countryCode',
        targetColumn: 'code'
    })
    readonly country?: Country;

    @HasOne({
        target: Country,
        column: 'countryCode',
        targetColumn: 'code',
        lazy: true
    })
    readonly countryLazy?: LazyResolver<Country>;

}
